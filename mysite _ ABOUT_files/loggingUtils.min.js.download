function _toConsumableArray(e){if(Array.isArray(e)){for(var i=0,t=Array(e.length);i<e.length;i++)t[i]=e[i];return t}return Array.from(e)}define("loggingUtils/bi/errors.json",[],function(){return{SINGLE_PAGE_RETRIEVAL_ATTEMPT_FAILED:{errorCode:111020,severity:"warning",params:{p2:"pageId",p1:"hostname",p3:"url",p4:"responseStatusCode"}},ALL_PAGE_RETRIEVAL_ATTEMPTS_FAILED:{errorCode:111021,severity:"fatal",params:{p1:"pageId"}},UNHANDLED_LINK_TYPE_IN_DATA_FIXER:{errorCode:21067,severity:"fatal",params:{p1:"newLinkDataItem"}},DATA_PLUGIN_ERROR:{errorCode:111029,severity:"fatal",params:{p1:"store",p2:"path",p3:"value",p4:"stack"}}}}),define("loggingUtils/bi/services/wixBI",["lodash","coreUtils"],function(e,i){"use strict";function t(e,t,n,u,g){var c=i.urlUtils.joinURL(t,n);u&&(c+="?"+u),e.wixBiSession.sendBeacon(c,g),a&&o&&function(e){if(r){var t=window._biCalls;if(t){var n=t.push(i.urlUtils.parseUrl(e));n>s&&t.splice(0,n>>2)}}}(c)}function n(n,r){var a=e.get(n,["serviceTopology","biServerUrl"]);a&&(u.biUrl=a),e.defaults(r,u);var s=!1!==r.useBeacon,g=e.isString(r.queryString)?r.queryString:i.urlUtils.toQueryString(e.defaults(r.params,{ts:function(i,t){var n=o&&"editor"===t.adapter?window.parent.mainLoaded:0;return n=n||i.wixBiSession.initialTimestamp||i.wixBiSession.mainLoaded,e.now()-n}(n,r)}));t(n,r.biUrl,r.adapter,g,s)}var r="undefined"!=typeof window,o=r&&window.queryUtil&&window.queryUtil.isParameterTrue("isEdited"),a=r&&window.queryUtil&&window.queryUtil.isParameterTrue("isqa"),s=1e3;a&&o&&(window._biCalls=[]);var u={biUrl:"//frog.wixpress.com",adapter:"",params:{}};return{report:n}}),define("loggingUtils/bi/services/googleAnalytics",["lodash","coreUtils"],function(e,i){"use strict";function t(i,t,n){e.isEmpty(i)||(window.ga?n():requirejs(["//www.google-analytics.com/analytics.js"],function(){window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=e.now(),window.ga.q=window.ga.q||[],e.forEach(i,function(e){window.ga("create",e,"auto")}),t&&window.ga("set","anonymizeIp",!0),n()},e.noop))}return{reportPageEvent:function(n,r,o,a){"undefined"!=typeof window&&setTimeout(function(){n.isUsingUrlFormat(i.siteConstants.URL_FORMATS.SLASH)?t(o,n.ipAnonymization,function(){window.ga("send","pageview",{page:r})}):function(i,t,n){function r(){var r=window._gaq||[];window._gaq=r,e.forEach(t,function(e,t){var o=0===t?"":"t"+t+".";r.push([o+"_setAccount",e],[o+"_setAllowAnchor",!0]),n&&r.push([o+"_setCustomVar",1,"version",n.ver,1],[o+"_setCustomVar",2,"language",n.lng,1],[o+"_setCustomVar",3,"userType",n.userType,1]),r.push([o+"_trackPageview",i])})}window._gaq?r():requirejs(["https://stats.g.doubleclick.net/dc.js"],r,e.noop)}(r,o,a)},200)},report:function(i,n){var r=e.drop(arguments,2);t(i,n,function(){window.ga.apply(window.ga,r)})}}}),define("loggingUtils/bi/services/facebookRemarketing",["lodash","coreUtils"],function(e,i){"use strict";function t(i){return Number(i)&&e.isString(i)&&!e.isEmpty(i)}function n(e){return e.isUsingUrlFormat(i.siteConstants.URL_FORMATS.SLASH)}function r(i,t,r,o){(function(i,t,r){return n(i)&&window.fbq&&e.isString(t)&&e.isString(r)})(i,t,r)&&window.fbq(t,r,o||{})}return{initRemarketingPixel:function(e,i){t(i)&&(n(e)?function(e){var i=void 0,t=void 0,n=void 0;window.fbq||(i=window.fbq=function(){i.callMethod?i.callMethod.apply(i,arguments):i.queue.push(arguments)},window._fbq||(window._fbq=i),i.push=i,i.loaded=!0,i.version="2.0",i.queue=[],(t=window.document.createElement("script")).async=!0,t.src="//connect.facebook.net/en_US/fbevents.js",(n=window.document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,n)),window.fbq("init",e),window.fbq("track","PageView")}(i):function(e){if(!window._fbq){var i=window._fbq||(window._fbq=[]);if(!i.loaded){var t=window.document.createElement("script");t.async=!0,t.src="//connect.facebook.net/en_US/fbds.js";var n=window.document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),i.loaded=!0}i.push(["addPixelId",e]),window._fbq.push(["track","PixelInitialized",{}])}}(i))},initPixelId:function(e,i){t(i)&&n(e)&&this.initRemarketingPixel(e,i)},fireRemarketingPixel:function(e,i,t){r(e,"track",i,t)},fireCustomEvent:function(e,i,t,n){r(e,i,t,n)}}}),define("loggingUtils/bi/services/googleRemarketing",["lodash"],function(e){"use strict";function i(i){!t&&function(i){return e.isArray(i)&&1===i.length&&Number(i[0])}(i)&&(e.assign(n,{google_conversion_id:i[0]}),function(){var e=window.document.createElement("script");e.type="text/javascript",e.src="//www.googleadservices.com/pagead/conversion_async.js",e.async=!0,e.setAttribute("onload","google_trackConversion("+JSON.stringify(n)+")");var i=window.document.getElementsByTagName("script")[0];i.parentNode.insertBefore(e,i)}(),t=!0)}var t=!1,n={google_custom_params:{},google_remarketing_only:!0};return{initRemarketingPixel:i,fireRemarketingPixel:function(){t&&window.google_trackConversion&&window.google_trackConversion(n)}}}),define("loggingUtils/bi/services/yandexMetrika",["lodash"],function(e){"use strict";function i(e){(window[t]=window[t]||[]).push(function(){try{window[r]=new window.Ya.Metrika(function(e){return{id:parseInt(e,10),clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0,trackHash:!0}}(e))}catch(e){}})}var t="yandex_metrika_callbacks",n=!1,r=void 0;return{initialize:function(t){(function(i){return e.isArray(i)&&e.isFinite(parseInt(i[0],10))})(t)&&(function(e){r="yaCounter"+e}(t[0]),i(t[0]),function(){if(!n){var e=window.document.getElementsByTagName("script")[0],i=window.document.createElement("script");i.type="text/javascript",i.async=!0,i.src="https://mc.yandex.ru/metrika/watch.js",i.addEventListener("load",function(){n=!0}),e.parentNode.insertBefore(i,e)}}())},reportPageHit:function(i){n&&window[r]&&e.isFunction(window[r].hit)&&window[r].hit(i)}}}),define("loggingUtils/bi/services/googleTagManagerLoader",["lodash"],function(e){"use strict";return{load:function(i,t){requirejs(["//www.googletagmanager.com/gtm.js?id="+i],t,e.noop)}}}),define("loggingUtils/bi/services/googleTagManager",["lodash","loggingUtils/bi/services/googleTagManagerLoader"],function(e,i){"use strict";function t(t,n){window.dataLayer?n():i.load(t,function(){window.dataLayer=window.dataLayer||[],window.dataLayer.push({"gtm.start":e.now(),event:"gtm.js"}),n()})}return{reportPageEvent:function(e,i){"undefined"!=typeof window&&setTimeout(function(){t(i,function(){window.dataLayer.push({event:"Pageview",url:e})})},200)},report:function(e,i){t(e,function(){var e;(e=window.dataLayer).push.apply(e,_toConsumableArray(i))})}}}),define("loggingUtils/bi/bi",["loggingUtils/bi/services/wixBI","loggingUtils/bi/services/googleAnalytics","loggingUtils/bi/services/facebookRemarketing","loggingUtils/bi/services/googleRemarketing","loggingUtils/bi/services/yandexMetrika","loggingUtils/bi/services/googleTagManager"],function(e,i,t,n,r,o){"use strict";return{wixBI:e,googleAnalytics:i,facebookRemarketing:t,googleRemarketing:n,yandexMetrika:r,googleTagManager:o}}),define("loggingUtils/logger/newrelic",["lodash"],function(e){"use strict";if(!("undefined"==typeof window||window.queryUtil&&window.queryUtil.isParameterTrue("suppressbi"))){var i=void 0;try{i=window.parent.newrelic}catch(e){i=window.newrelic}if(i){var t=window.performance&&window.performance.now?function(){return Math.round(window.performance.now())}:function(){return 0};return{setCustomAttribute:i.setCustomAttribute.bind(i),addPageAction:function(n,r){var o=t();return r=e.assign({},r,{timeSinceNavigate:o}),i.addPageAction(n,r)},finished:function(){return t()&&this.setCustomAttribute("timeSinceNavigate",t()),i.finished.apply(i,arguments)}}}}return{setCustomAttribute:e.noop,addPageAction:e.noop,finished:e.noop}}),define("loggingUtils/logger/performance",["lodash","loggingUtils/logger/newrelic"],function(e,i){"use strict";function t(){return-1}var n="undefined"!=typeof window&&window.queryUtil;if(!n||n.isParameterTrue("suppressperformance"))return{mark:e.noop,measure:e.noop,start:e.noop,startOnce:e.noop,finish:e.noop,time:function(e,i){return i.apply(this,Array.prototype.slice.call(arguments,2))},getMark:e.noop,getMeasure:e.noop,clearMarks:e.noop,clearMeasures:e.noop,now:e.now,getResourceSize:t};var r=void 0,o=window.performance;if(o&&o.now)r=o.now.bind(o);else{var a=window.wixBiSession&&window.wixBiSession.initialTimestamp||0;r=function(){return e.now()-a}}var s=function(t,n){t&&(n=e.defaults({measureName:t.name,startTime:Math.round(t.startTime),duration:Math.round(t.duration)},n),i.addPageAction("measure",n))},u=void 0;if(o&&o.measure){var g=function(i,t){return e.find(o.getEntriesByName(t),{entryType:i})};u={mark:o.mark.bind(o),measure:function(e,i,t,n,r){try{o.measure(e,i,t),n&&s(u.getMeasure(e),r)}catch(e){}},getMark:g.bind(this,"mark"),getMeasure:g.bind(this,"measure"),clearMarks:o.clearMarks.bind(o),clearMeasures:o.clearMeasures.bind(o)}}else{var c={domLoading:{name:"domLoading",startTime:0}},l={},d=function(e,i){i?delete e[i]:e={}};u={mark:function(e){c[e]={name:e,startTime:r()}},measure:function(e,i,t,n,r){var o=u.getMark(i),a=u.getMark(t);if(o&&a){var g={name:e,startTime:o.startTime,duration:a.startTime-o.startTime};isNaN(g.duration)||(l[e]=g,n&&s(g,r))}},getMark:function(e){return c[e]},getMeasure:function(e){return l[e]},clearMarks:d.bind(this,c),clearMeasures:d.bind(this,l)}}return u.start=function(e){u.clearMeasures(e),u.mark(e+" start")},u.startOnce=function(e){u.getMark(e+" start")||u.start(e)},u.finish=function(e,i,t){var n=e+" start";if(u.getMark(n)){var r=e+" finish";u.mark(r),u.measure(e,n,r,i,t),u.clearMarks(r),u.clearMarks(n)}return u.getMeasure(e)},u.time=function(e,i,t,n){try{return u.start(e),i.apply(this,Array.prototype.slice.call(arguments,4))}finally{u.finish(e,t,n)}},u.now=r,o&&window.performance.getEntriesByName?u.getResourceSize=function(i){var t=o.getEntriesByName(i);if(t&&t.length){var n=t[0],r=n.transferSize||n.encodedBodySize;if(e.isNumber(r))return r}return-1}:u.getResourceSize=t,u}),define("loggingUtils/logger/services/browsingSession",["lodash","coreUtils"],function(e,i){"use strict";function t(){try{return{isNew:!1,ts:parseInt(window.localStorage.getItem(r),10),id:window.localStorage.getItem(o)}}catch(e){return{isNew:!1,ts:null,id:null}}}function n(){var n=!1;return function(){var e=!1,i=Date.now(),n=t();return(isNaN(n.ts)||i-n.ts>a)&&(e=!0),e}()&&(!function(){try{var e=Date.now(),t=i.guidUtils.getGUID();window.localStorage.setItem(r,e),window.localStorage.setItem(o,t)}catch(e){return{ts:null,id:null}}}(),n=!0),function(){try{var e=Date.now();window.localStorage.setItem(r,e)}catch(e){return null}}(),e.assign(t(),{isNew:n})}var r="beatSessionTs",o="beatSessionId",a=18e5;return{SESSION_TS_KEY:r,SESSION_ID_KEY:o,SESSION_TTL_MS:a,get:t,track:n}}),define("loggingUtils/logger/beat",["lodash","loggingUtils/bi/bi","coreUtils","loggingUtils/logger/performance","loggingUtils/logger/services/browsingSession","experiment"],function(e,i,t,n,r,o){"use strict";function a(i,n,r,o){var a=function(i){return{vuuid:function(){var i=t.cookieUtils.getCookie("_wixUIDX")||"";return i=i.slice(e.lastIndexOf(i,"|")+1),i=i.replace(/^(null-user-id|null)$/g,"")}(),vid:i.getSvSession()||h,dc:function(i){if(e.isString(i)){var t=i.split(".");if(t.length>1)return t[1]}return i}(i.serviceTopology.serverName),vsi:m[i.siteId].viewerSessionId,uuid:i.siteHeader.userId,sid:i.siteId,iss:e.invoke(i,"isClientAfterSSR",!1),msid:i.getMetaSiteId()}}(i),u=function(i,t,n){var r=i.biData,o=r.getTime(),a=k(t,r),s=i.wixBiSession,u={pid:n,pn:r.getPageNumber(),st:function(i){var t=i.rendererModel.siteInfo.documentType,n=e.indexOf(p,t);return-1!==n?n:t}(i),sr:function(){if("undefined"==typeof window)return"";var e=window.screen&&window.screen.width||0,i=window.screen&&window.screen.height||0;return e+"x"+i}(),wr:function(){if("undefined"==typeof window)return"";var e=0,i=0;window.innerWidth?(e=window.innerWidth,i=window.innerHeight):window.document&&(window.document.documentElement&&window.document.documentElement.clientWidth?(e=window.document.documentElement.clientWidth,i=window.document.documentElement.clientHeight):window.document.body&&window.document.body.clientWidth&&(e=window.document.body.clientWidth,i=window.document.body.clientHeight));return e+"x"+i}(),isjp:s.maybeBot?"1":"0",isp:i.isPremiumDomain(),url:function(e){return e.replace(/^http(s)?:\/\/(www\.)?/,"").substring(0,256)}(i.currentUrl.full),ref:window.document.referrer,ts:"start"===t?0:o.loadingTime,tts:"start"===t?0:o.totalLoadingTime,c:e.now(),v:i.baseVersion||"unknown",fis:a.isNew,bsi:a.id};"finish"===t&&"undefined"!=typeof window&&window.santaRenderingError&&(u.ssr_fb=window.santaRenderingError.reason);s&&s.checkVisibility&&(u.ita=s.checkVisibility());return u}(i,r,o),g={et:s(r)};return e.merge({},n,a,u,g)}function s(i){var t=e.indexOf(v,i);return-1!==t?t:i>3?i:-1}function u(e,i){return e&&e.wixBiSession.viewerSessionId&&"preview"!==e.viewMode&&!t.stringUtils.isTrue(e.currentUrl.query.suppressbi)&&-1!==s(i)&&(!U(i)||!function(e){var i=d[e];return d[e]=!0,i}(i))}function g(i,n){return{queryString:function(i){var n=t.urlUtils.toQueryString(e.omit(i,y),!0);return e.reduce(y,function(e,n){return e+"&"+t.urlUtils.toQueryParam(n,i[n],!0)},n)}(n),adapter:_.adapter,biUrl:i.getServiceTopologyProperty("biServerUrl")||_.biUrl}}function c(i,t){var n=i.currentUrl.query.sampleratio;return!(!(e.result(i,"isDebugMode",!1)&&"force"!==n||"none"===n)&&t)||(o.isOpen("vsiCoin",i)&&i.wixBiSession.viewerSessionId?(e.isUndefined(i.wixBiSession.coin)&&(i.wixBiSession.coin=parseInt(i.wixBiSession.viewerSessionId,16)),i.wixBiSession.coin%t==0):0===Math.floor(i.wixBiSession.random*t))}function l(e,r,o){!function(e){m[e.siteId]=m[e.siteId]||{viewerSessionId:e.wixBiSession.viewerSessionId||t.guidUtils.getGUID()}}(e);var s=a(e,S,r,o);if(function(e,i){var t=i.et;w.et=t,e.wixBiSession.et=t}(e,s),u(e,r)&&function(e,t){if(c(e,b[t.et])){var n=g(e,t);i.wixBI.report(e,n)}}(e,s),e.isViewerMode()){var l=e.viewMode;l="site"===l?"":" "+l,E||(n.measure("main-r started"+l,"domLoading","beat 4",!0),n.measure("utils loaded"+l,"beat 4","beat 5",!0),E="beat 5");var d="beat "+r;n.mark(d);var f=I[r]||r;n.measure(f+l,E,d,!0),E=d}}var d=[],f=("undefined"!=typeof window?window:{}).wixBiSession,w=void 0===f?{}:f;w.beat&&w.beat(5);var m={},p=["No Site Type","WixSite","UGC","Template"],v=["No Event Type","start","visible","finish"],h="NO_SV",_={adapter:"bt",biUrl:"http://frog.wix.com/"},S={src:29,evid:3},y=["url","ref"],I={6:"packages loaded",7:"load data",8:"render",finish:"layout",16:"TPAs"},b={16:20},k=function(e){return"finish"===e?r.track():r.get()},U=function(e){return e>3&&16!==e},E=void 0;return{reportBeatEvent:l,shouldIncludeInSampleRatio:c}}),define("loggingUtils/logger/logger",["lodash","loggingUtils/bi/bi","loggingUtils/logger/beat","coreUtils"],function(e,i,t,n){"use strict";function r(i,t){var r={};return(44===i.src||42===i.src&&t)&&(r.visitor_id=t),e.assign(r,{errn:i.errorName,evid:10,sev:function(e){return"string"==typeof e?_[e]:e}(i.severity),cat:m?1:2,iss:1,ut:n.cookieUtils.getCookie("userType")})}function o(i,t,o,a){var g=void 0,c=function(i){y[i.siteId]=y[i.siteId]||i.wixBiSession.viewerSessionId||n.guidUtils.getGUID();var t=i.serviceTopology.serverName?e.head(i.serviceTopology.serverName.split(".")):"",r={site_id:i.siteId,msid:function(i){return e.isFunction(i.getMetaSiteId)?i.getMetaSiteId():i.rendererModel.metaSiteId}(i),majorVer:p,ver:function(e){var i=e.santaBase&&e.santaBase.match(/([\d\.]+)\/?$/);return i&&i[1]||""}(i),server:t,viewMode:i.viewMode};m||(r.vsi=y[i.siteId]);return r}(i);switch(t){case"error":g=function(i,t,n){var o=e.merge({src:44,sev:30,errn:"error_name_not_found"},u(i,h),r(i,n),s(i,t));return t&&t.description&&(o.desc=JSON.stringify(t.description).slice(0,512)),o}(o,a,d(i));break;case"event":g=function(i,t){return e.merge({src:42},u(i,S),s(i,t))}(o,a)}return e.merge(g,c)}function a(e){return"string"==typeof e?encodeURIComponent(e):e}function s(i,t){var n=i.params;return e.isArray(n)?e.pick(t,n):e.isObject(n)?e.mapValues(n,function(e){return a(t[e])}):e.mapValues(t,a)}function u(i,t){return e.transform(i,function(e,i,n){var r=t[n];r&&(e[r]=i)},{})}function g(e){return n.stringUtils.isTrue(e.currentUrl.query.suppressbi)}function c(i,n){return!g(i)&&!function(e){return!!e&&(e.callCount=e.callCount||0,e.callCount++,e.callLimit&&e.callCount>e.callLimit)}(n)&&function(i,n){if(i.forceBI)return!0;var r=v;return n&&(e.result(i,"isWixSite",!1)&&"wixSiteSampleRatio"in n?r=n.wixSiteSampleRatio:"sampleRatio"in n?r=n.sampleRatio:("errorCode"in n||"editor"===n.endpoint)&&(r=0)),!(r&&r>=1)||t.shouldIncludeInSampleRatio(i,r)}(i,n)}function l(t,n,r){if(t&&e.isObject(n)&&c(t,n)){var a=function(e,i,t){var n=i.reportType||(i.errorCode||i.errc?"error":"event"),r={biUrl:e.serviceTopology.biServerUrl,adapter:i.adapter||i.endpoint||("error"===n?"trg":"ugc-viewer"),params:o(e,n,i,t)};return"useBeacon"in i&&(r.useBeacon=i.useBeacon),r}(t,n,r);i.wixBI.report(t,a)}}function d(e){return y[e.siteId]||e.wixBiSession&&e.wixBiSession.viewerSessionId}function f(e,i){var t=e.isPremiumDomain();switch(i){case"googleAnalytics":if(w(e,i))return[e.googleAnalytics];break;case"googleTagManager":if(w(e,i))return[e.googleTagManager];break;case"facebookRemarketing":if(w(e,i)&&t)return[e.facebookRemarketing];break;case"googleRemarketing":if(w(e,i)&&t)return[e.googleRemarketing];break;case"yandexMetrika":if(w(e,i)&&t)return[e.yandexMetrika]}return[]}function w(i,t){return!e.isEmpty(i[t])}var m="undefined"!=typeof window&&window.queryUtil&&window.queryUtil.isParameterTrue("isEdited"),p="undefined"==typeof window||window.clientSideRender?3:4,v=10,h={errorName:"errn",errorCode:"errc",errc:"errc",src:"src",severity:"sev",sev:"sev",packageName:"errscp"},_={recoverable:10,warning:20,error:30,fatal:40},S={eventId:"evid",evid:"evid",src:"src"},y={};return{reportBI:l,reportGoogleAnalytics:function(t){if(!m){var n=f(t,"googleAnalytics");i.googleAnalytics.report.apply(null,[n,t.ipAnonymization].concat(e.tail(arguments)))}},reportGoogleTagManager:function(t,n){if(!m){var r=f(t,"googleTagManager");e.isEmpty(r)||i.googleTagManager.report(r[0],n)}},reportPageEvent:function(t,n){if(t&&e.isString(n)&&!m&&!g(t)){i.googleAnalytics.reportPageEvent(t,n,f(t,"googleAnalytics"));var r=f(t,"googleTagManager");e.isEmpty(r)||i.googleTagManager.reportPageEvent(n,r[0])}},register:function(i,t,n){e.forOwn(n,function(e){e.packageName=i})},reportBeatEvent:t.reportBeatEvent,initFacebookRemarketingUserPixel:function(e){if(!m&&!g(e)){var t=f(e,"facebookRemarketing")[0];i.facebookRemarketing.initRemarketingPixel(e,t)}},initFacebookRemarketingPixelId:function(e,t){m||g(e)||i.facebookRemarketing.initPixelId(e,t)},fireFacebookRemarketingPixel:function(e,t,n){i.facebookRemarketing.fireRemarketingPixel(e,t,n)},fireFacebookCustomEvent:function(e,t,n,r){i.facebookRemarketing.fireCustomEvent(e,t,n,r)},initGoogleRemarketingPixel:function(e){m||g(e)||i.googleRemarketing.initRemarketingPixel(f(e,"googleRemarketing"))},fireGoogleRemarketingPixel:function(){i.googleRemarketing.fireRemarketingPixel()},initYandexMetrika:function(e){m||g(e)||i.yandexMetrika.initialize(f(e,"yandexMetrika"))},reportYandexPageHit:function(e){i.yandexMetrika.reportPageHit(e)},shouldSendReport:c,getVisitorId:d}}),define("loggingUtils/bi/errors",["loggingUtils/bi/errors.json","lodash","loggingUtils/logger/logger"],function(e,i,t){"use strict";return i.forEach(e,function(e,i){e.errorName=i}),t.register("utils","error",e),e}),define("loggingUtils/logger/services/imageContext",["lodash","loggingUtils/logger/performance"],function(e,i){"use strict";function t(){this._current=null}function n(e,i,t){this._siteData=e,this._pageId=i.pageId,this._events=t,this._interval=0,this._finishCount=1,this._failDetailsBuffer=[],this._status=o.INITIAL,this._reason=a.INITIAL,this._images={total:0,success:0,fail:0,failDetails:[],totalSize:0}}var r={SUCCESS:0,FAIL:1},o={INITIAL:0,PROGRESS:1,FINISHED:2},a={INITIAL:0,SUCCESS_OR_FAIL:1,TIMED_OUT:2,DESTROYED:3},s={},u=/\/(v[0-9.]+\/.+)$/,g=/\/([^\/]+)$/;t.prototype={createImageContext:function(e,i,t,r,o){return this._current=new n(i,{pageId:e},{onProgress:t,onSuccess:r,onFail:o})},getCurrentImageContext:function(){return this._current}},n.prototype={_isFinished:function(){return this._images.total===this._images.success+this._images.fail},_isFinishSuccess:function(){return this._isFinished()&&0===this._images.fail},_checkFinished:function(){this._finishCount<=10&&this._isFinished()&&(this._finish(a.SUCCESS_OR_FAIL),this._isFinishSuccess()?this._events.onSuccess(this):this._events.onFail(this),this._finishCount++)},_startProgress:function(){var e=this,i=1;this._status=o.PROGRESS,this._interval=setInterval(function(){e._flushFailDetailsBuffer(),e._events.onProgress(e,i++),i>10&&e._finish(a.TIMED_OUT)},3e3)},_stopProgress:function(){this._interval&&(clearInterval(this._interval),this._interval=0)},_finish:function(e){this._status=o.FINISHED,this._reason=e,this._failDetailsBuffer.length&&this._flushFailDetailsBuffer(),this._stopProgress()},_onImageStatusChange:function(t,n){if(!(this._status<o.PROGRESS||this._reason>a.SUCCESS_OR_FAIL||n.canceled)){if(t===r.SUCCESS){var s=n.target?i.getResourceSize(n.target.src):0;this._increaseSuccessCount(s)}else{var c=n.target?function(i){if(e.isString(i)){var t=i.match(u);return t||(t=i.match(g))?t[1]:""}return""}(n.target.src):"";this._increaseFailCount(c)}this._checkFinished()}},_increaseSuccessCount:function(e){this._images.success++,this._images.totalSize+=e},_increaseFailCount:function(e){var i=this._siteData.biData.getTime();this._images.fail++,this._failDetailsBuffer.push({d:i.totalLoadingTime,url:e})},_flushFailDetailsBuffer:function(){this._images.failDetails.push(this._failDetailsBuffer),this._failDetailsBuffer=[]},getImages:function(){return this._images},getPageId:function(){return this._pageId},setImages:function(i){var t=function(i,t,n){return e.filter(i,function(e){var i=e.id;return s[i]?n&&!!s[i][t]:(s[i]={},s[i][t]=!0,!0)})}(i,this.getPageId(),this._status===o.INITIAL);return this._images.total+=t.length,this._status===o.INITIAL&&(this._startProgress(),this._checkFinished()),function(i,t,n){e.forEach(i,function(e){e.promise.then(t,n)})}(t,this._onImageStatusChange.bind(this,r.SUCCESS),this._onImageStatusChange.bind(this,r.FAIL)),this},destroy:function(){this._finish(a.DESTROYED)}};var c={_sites:{},get:function(e){return this._sites[e.siteId]=this._sites[e.siteId]||new t}};return{create:function(i,t,n,r,o){return n=n||e.noop,r=r||e.noop,o=o||e.noop,c.get(i).createImageContext(t,i,n.bind(null,i),r.bind(null,i),o.bind(null,i))},getCurrent:function(e){return c.get(e).getCurrentImageContext()}}}),define("loggingUtils/logger/imagesBi",["lodash","loggingUtils/bi/bi","coreUtils","loggingUtils/logger/beat","loggingUtils/logger/services/imageContext"],function(e,i,t,n,r){"use strict";function o(i){return JSON.stringify({a:e.take(i,c)})}function a(i,n,r){var o=e.defaults(function(e,i){var n=i.getImages(),r=n.totalSize>=0?Math.round(n.totalSize/1024):"",o=e.biData;return{src:29,d:o.getTime().totalLoadingTime,tn:n.total,sid:e.siteId,msid:e.getMetaSiteId(),pid:i.getPageId(),pn:o.getPageNumber(),vsi:e.wixBiSession.viewerSessionId,vid:t.cookieUtils.getCookie("svSession"),s:r}}(i,n),r);return{adapter:"m",queryString:t.urlUtils.toQueryString(o)}}function s(e,t,n){var r=t.getImages();i.wixBI.report(e,a(e,t,{evid:11,i:n,sn:r.success,fn:r.fail,fd:o(r.failDetails[n-1])}))}function u(e,t){i.wixBI.report(e,a(e,t,{evid:12}))}function g(t,n){var r=n.getImages();i.wixBI.report(t,a(t,n,{evid:13,fn:r.fail,fd:o(e.flatten(r.failDetails))}))}var c=8;return function(e,i){if(function(e){return e.isViewerMode()&&n.shouldIncludeInSampleRatio(e)&&!t.stringUtils.isTrue(e.currentUrl.query.suppressbi)}(e)){var o=e.biData.getPageId(),a=r.getCurrent(e);return a&&a.getPageId()===o||(a&&a.destroy(),a=r.create(e,o,s,u,g)),a=a.setImages(i)}}}),define("loggingUtils/logger/performanceMetrics",[],function(){"use strict";return{BEAT_1_TO_4:"main-r started",BEAT_4_TO_5:"utils loaded",BEAT_5_TO_6:"packages loaded",BEAT_6_TO_7:"load data",RENDER:"render",RENDER_PREPARE:"prepare",LAYOUT:"layout",PAGE_FIXER:"Fix page",MASTER_PAGE_FIXER:"Fix page masterPage",RE_RENDER:"reRender",RE_LAYOUT:"reLayout",SAVE:{SAVE_DATA_FIXER:"save-data-fixer"},AUTOSAVE:{PRESAVE_OPERATIONS:"autosave-presave-operations",SEND_AJAX:"autosave-send-ajax",CALC_DIFF:"autosave-calc-diff",LOAD_AJAX:"autosave-load-ajax",LOAD_APPLY:"autosave-load-apply"},DS_INIT:"documentServices initMethod",MOBILE:{CONVERT_PAGE:"convertPage",MERGE_ALL_PAGES:"mergeAllPages"}}}),define("loggingUtils",["loggingUtils/bi/errors","loggingUtils/logger/logger","loggingUtils/logger/performance","loggingUtils/logger/newrelic","loggingUtils/logger/imagesBi","loggingUtils/logger/performanceMetrics"],function(e,i,t,n,r,o){"use strict";return{bi:{errors:e},logger:i,performance:t,newrelic:n,imagesBi:r,performanceMetrics:o}});
//# sourceMappingURL=loggingUtils.min.js.map