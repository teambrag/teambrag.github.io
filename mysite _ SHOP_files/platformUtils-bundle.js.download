!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("lodash"));else if("function"==typeof define&&define.amd)define(["lodash"],t);else{var n=t("object"==typeof exports?require("lodash"):e.lodash);for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,function(e){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=20)}([function(t,n){t.exports=e},function(e,t,n){"use strict";var o=n(19);e.exports={items:{getAddedItems:o.getAddedItems,getRemovedItems:o.getRemovedItems,getTemplateCompsId:o.getTemplateCompIds},structure:{getUniqueDisplayedId:o.getUniqueDisplayedId,getOriginalId:o.getOriginalId,getItemId:o.getItemId,SPLITTED_DATA_TYPES:o.SPLITTED_DATA_TYPES}}},function(e,t,n){"use strict";function o(e){return"https://dailymotion.com/video/"+e}function r(e){var t=/dailymotion\.com\/(?:video|playlist)\/([^_\/]+)/gi,n=t.exec(e);if(n&&n.length&&n[1])return n[1]}e.exports={getVideoUrl:o,getVideoIdFromUrl:r}},function(e,t,n){"use strict";function o(e){return"https://www.facebook.com/"+e}function r(e){var t=/facebook\.com\/(.+\/videos\/[A-Za-z0-9._%-]*)/gi,n=t.exec(e);if(n&&n.length&&n[1])return n[1]}e.exports={getVideoUrl:o,getVideoIdFromUrl:r}},function(e,t,n){"use strict";function o(e){return"https://vimeo.com/"+e}function r(e){var t=/vimeo\.com\/(\d+)$/gi,n=t.exec(e);if(n&&n.length&&n[1])return n[1]}e.exports={getVideoUrl:o,getVideoIdFromUrl:r}},function(e,t,n){"use strict";function o(e){return"https://www.youtube.com/watch?v="+e}function r(e){var t=/(?:youtube\.com\/watch[^\s]*[\?&]v=)([\w-]+)/g,n=/(?:youtu\.be\/)([\w-]+)/g,o=t.exec(e)||n.exec(e);if(o&&o.length&&o[1])return o[1]}e.exports={getVideoUrl:o,getVideoIdFromUrl:r}},function(e,t,n){"use strict";function o(e){return e.replace(/^(.*[\/])/,"")}function r(e){var t=e.match(/(?:\/|^)([0-9a-fA-F_]+)(?:\/|$)/);return t.length>1?t[1]:""}function i(e,t){if(e.length<=t)return e;var n=e.split(""),o=e.length-t+m.length,r=e.lastIndexOf(".")>e.length-o-g,i=r?e.lastIndexOf("."):e.length-1,a=i-o-g;return n.splice(a,o,m),n.join("")}function a(e){var t=e.fileOutput||e.file_output;return f.map(t.image,function(e){return o(e.url)})}function s(e){var t=e.fileOutput||e.file_output,n=f.filter(t.video,{format:"mp4"}),o=f.head(f.get(t,"storyboard")),r=f.map(n,function(e){return f.pick(e,["width","height","quality","url"])});return o&&r.push({quality:"storyboard",width:o.width,height:o.height,url:o.url}),r}function c(e,t){var n=e.fileInput||e.file_input,c=e.fileOutput||e.file_output,u=r(e.fileUrl||e.file_name),p=i(e.title,v),l=s(e),d=f.head(c.image),m={type:"Image",width:d.width,height:d.height,uri:o(d.url),description:t.path?t.path:void 0};return{type:"WixVideo",title:p,videoId:u,duration:+(n.duration/1e3).toFixed(2),posterImageRef:m,generatedPosters:a(e),qualities:l,artist:{name:e.vendor||"",id:e.reference||""},hasAudio:-1!==f.head(c.video).audio_bitrate,fps:f.get(f.head(c.video),"fps","").toString()}}function u(e,t){var n=c(e,t);return f.assign(n,h)}function p(e,t){var n=c(e,t);return f.assign(n,y)}function l(e,t,n,o){return{type:"WixVideo",videoId:e,posterImageRef:{type:"Image",uri:t,width:n,height:o}}}function d(e,t){return{type:"Image",uri:e.fileName,title:i(e.title,v),description:t.path,width:e.width,height:e.height,artist:{name:e.vendor||"",id:e.reference||""}}}var f=n(0),m="...",g=3,h={opacity:1,autoplay:!0,loop:!0,preload:"auto",mute:!0},y={opacity:1,autoplay:!1,loop:!1,preload:"none",mute:!1},v=100;e.exports={getVideoBackgroundObject:u,getVideoPosterObject:l,getMediaPlayerVideoObject:p,getImageBackgroundObject:d,fixMediaTitleLength:i}},function(e,t,n){"use strict";function o(e){var t=e.replace("_",".").replace("/",".").split(".");return[t[2],t[3],"svg_"+t[1],t[4]].join(".")}function r(e){return"svgshape.v2.Svg_"+/^shapes\/([a-z0-9]{32})\.svg$/i.exec(e)[1]}var i=n(0);e.exports={parseSvgSkinFromUrl:function(e){return i.includes(e,".v1.")?o(e):r(e)}}},function(e,t,n){"use strict";function o(e,t){return l[e.toUpperCase()]&&l[e][t]}function r(e){if(e&&e.videoType&&e.videoId){var t=o(e.videoType,"getVideoUrl");return t&&t(e.videoId)||""}return""}function i(e){var t=void 0;return p.forEach(l,function(n,r){var i=o(r,"getVideoIdFromUrl"),a=i&&i(e);if(!p.isEmpty(a))return t={videoType:r,videoId:a},!1}),t}var a=n(5),s=n(4),c=n(2),u=n(3),p=n(0),l={YOUTUBE:a,VIMEO:s,DAILYMOTION:c,FACEBOOK:u};e.exports={getVideoUrl:r,getVideoDataFromUrl:i,videoTypes:{YOUTUBE:"YOUTUBE",VIMEO:"VIMEO",DAILYMOTION:"DAILYMOTION",FACEBOOK:"FACEBOOK"}}},function(e,t,n){"use strict";function o(e,t){for(var n=[t],o=0;o<n.length;o++){var r=i.get(e.components,[n[o],a])||[];n.push.apply(n,r)}return n.shift(),n}function r(e,t){for(var n=function(t){return i.get(e,["components",t,"parent"])},o=function(t){return i.get(e,["components",a,"type"])===s},r=t,a=n(r);a&&!o(a);)r=a,a=n(r);return o(a)&&i.includes(i.get(e,["components",a,"children"]),r)}var i=n(0),a="children",s="wysiwyg.viewer.components.Repeater";e.exports={getAllCompsUnderRoot:o,isTemplateComp:r}},function(e,t,n){"use strict";var o=n(17);e.exports={repeaters:o}},function(e,t,n){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t,n){this._model=e||{components:{},connections:{},componentsScopes:{},navigation:{},siteStructure:{},eventHandlers:{},EventTypes:{},sessionInfo:{},appsData:{},siteMemberData:{uid:null,permissions:null,onUserLogin:[]},scopesHierarchy:[{type:P,id:P,additionalData:{}}]},this._onUpdateCallback=t;var o=d.get(n,"_hooksManager"),r=d.get(n,"_transaction");this._hooksManager=o||new g,this._transaction=r||{_onTransaction:!1,_transactionData:{}}}function i(e){return e?d.get(this._model.scopesHierarchy,"0.id"):d.map(this._model.scopesHierarchy,function(e){return d.get(e,"id")})}function a(){var e;return e={},o(e,k,null),o(e,w,{}),o(e,_,null),o(e,h,{}),o(e,y,{}),o(e,v,{}),o(e,I,{}),o(e,T,{}),o(e,b,[]),o(e,S,!1),o(e,C,null),o(e,E,{}),o(e,O,{}),o(e,A,[]),o(e,x,[]),o(e,U,null),e}function s(e){return d.cloneDeep(d.get(this._model.components,[e,y]))}function c(e,t,n,o,r){var i={type:e,name:t,targetId:o,params:n};this._onUpdateCallback&&this._onUpdateCallback(o,D,i,r)}function u(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function p(e,t,n,o){var r=d.get(this._model,["components",e]);r&&(this._hooksManager.executeHooksAndUpdateValue(this,t,r.type,e,[n,o]),r[S]&&(this._model.components[e][t]=d.defaults({},n,r[t])),o&&(this._transaction._onTransaction?l.call(this,e,t,n):o(e,t,n)))}function l(e,t,n){var o=this._transaction._transactionData;if(o[e]||(o[e]={}),"registerEvent"===t)return o[e][t]||(o[e][t]=[]),void o[e][t].push(n);o[e][t]||(o[e][t]={}),d.assign(o[e][t],n)}var d=n(0),f=n(1),m=n(9),g=n(18),h="data",y="fullData",v="design",w="state",_="type",I="props",k="parent",b="events",T="layout",D="behavior",E="publicAPI",S="isDisplayed",O="style",C="id",A="children",x="displayedOnlyComponents",U="displayedRoot",P="GLOBAL_SCOPE";r.prototype.addComponent=function(e,t){var n=a();for(var o in n)n[o]=t[o]||n[o];n[k]=t[k],n[_]=t[_],n[C]=t[C],n[U]=t[U],this._model.components[e]=n,this._model.componentsScopes[e]=P},r.prototype.addNavigation=function(e){this._model.navigation=e},r.prototype.addSiteStructure=function(e){this._model.siteStructure=e},r.prototype.addConnections=function(e){this._model.connections=e},r.prototype.resetComponentsScope=function(){var e=this;for(var t in this._model.components)this._model.components[t].displayedOnlyComponents.forEach(function(t){return e._model.componentsScopes[t]=null})},r.prototype.addEventTypes=function(e){this._model.EventTypes=e},r.prototype.addSiteMemberData=function(e){var t=e.uid&&e.uid!==this._model.siteMemberData.uid;if(d.assign(this._model.siteMemberData,e),t){var n=this._model.siteMemberData.onUserLogin;d.forEach(n,function(t){t(e)})}},r.prototype.addAppsData=function(e){this._model.appsData=e},r.prototype.getAppsData=function(){return d.cloneDeep(this._model.appsData)},r.prototype.getAppData=function(e){return d.cloneDeep(d.get(this._model.appsData,e))},r.prototype.addOnUserLoginCallback=function(e){this._model.siteMemberData.onUserLogin.push(e)},r.prototype.addSessionInfoProp=function(e){d.assign(this._model.sessionInfo,e)},r.prototype.getComp=function(e){return d.cloneDeep(d.get(this._model.components,e))},r.prototype.getState=function(e){return d.cloneDeep(d.get(this._model.components,[e,w]))},r.prototype.getData=function(e){return d.cloneDeep(d.get(this._model.components,[e,h]))},r.prototype.getStyle=function(e){return d.cloneDeep(d.get(this._model.components,[e,O]))},r.prototype.getDesign=function(e){return d.cloneDeep(d.get(this._model.components,[e,v]))},r.prototype.getType=function(e){return d.cloneDeep(d.get(this._model.components,[e,_]))},r.prototype.getProps=function(e){return d.cloneDeep(d.get(this._model.components,[e,I]))},r.prototype.getEvents=function(e){return d.cloneDeep(d.get(this._model.components,[e,b]))},r.prototype.getLayout=function(e){return d.cloneDeep(d.get(this._model.components,[e,T]))},r.prototype.getId=function(e){return d.cloneDeep(d.get(this._model.components,[e,C]))},r.prototype.getEventTypes=function(){return d.cloneDeep(this._model.EventTypes)},r.prototype.getPublicAPI=function(e){var t=d.get(this._model.components,[e,E]);return d.isFunction(t)?t:d.cloneDeep(t)},r.prototype.getCallbackById=function(e,t){var n=this._model.eventHandlers[e];return t?n:d.get(n,"callback")},r.prototype.getParent=function(e){return d.cloneDeep(d.get(this._model.components,[e,k]))},r.prototype.getChildren=function(e){return d.clone(d.get(this._model.components,[e,A]))},r.prototype.getSiteStructure=function(){return d.cloneDeep(this._model.siteStructure)},r.prototype.getNavigationInfo=function(){return d.cloneDeep(this._model.navigation)},r.prototype.getFullDataWithOverrides=function(e){return d.defaults(this.getData(e),s.call(this,e))},r.prototype.getSiteMemberData=function(e){var t=d.cloneDeep(this._model.siteMemberData);if(e){var n=d.findKey(this._model.components,["data.id",e]),o=this.getData(n),r=d.get(o,"applicationId"),i=d.get(this._model.appsData,r);i&&d.assign(t,d.pick(i,["instance","instanceId"]))}return t},r.prototype.getSessionInfo=function(){return d.cloneDeep(this._model.sessionInfo)},r.prototype.setDataWithoutUpdate=function(e,t){p.call(this,e,h,t)},r.prototype.setData=function(e,t){p.call(this,e,h,t,this._onUpdateCallback)},r.prototype.setStyle=function(e,t,n){p.call(this,e,O,t,function(e,t,o){this._onUpdateCallback.call(this,e,t,o,n)}.bind(this))},r.prototype.setDesign=function(e,t){p.call(this,e,v,t,this._onUpdateCallback)},r.prototype.setProps=function(e,t,n){p.call(this,e,I,t,function(e,t,o){this._onUpdateCallback.call(this,e,t,o,n)}.bind(this))},r.prototype.setLayout=function(e,t){p.call(this,e,T,t,this._onUpdateCallback)},r.prototype.setPublicAPI=function(e,t){var n=d.get(this._model.components,e);n&&(n[E]=t)},r.prototype.getCurrentScope=function(){return d.clone(d.get(this._model.scopesHierarchy,0))},r.prototype.executeCompBehavior=function(e,t,n,o){c.call(this,"comp",t,n,e,o)},r.prototype.executeAnimation=function(e,t,n,o){c.call(this,"animation",t,n,e,o)},r.prototype.setUpdateCallback=function(e){this._onUpdateCallback=e},r.prototype.registerEvent=function(e,t,n,o,r){var i=void 0;void 0===r&&(r=o,o=void 0),d.isFunction(r)?(i=u(),this._model.eventHandlers[i]={callback:r,contextId:e,controllerId:o}):i=r;var a={contextId:e,eventType:n,callbackId:i},s=d.get(this._model,["components",t]);if(void 0!==s){if(this._hooksManager.executeHooksAndUpdateValue(this,"registerEvent",s.type,t,[e,n,o,r]),s.events.push({eventType:n,callbackId:i}),this._transaction._onTransaction)return void l.call(this,t,"registerEvent",a);d.isFunction(this._onUpdateCallback)&&this._onUpdateCallback(t,"registerEvent",a)}},r.prototype.toJson=function(){return this._model},r.prototype.getComponents=function(){var e={};for(var t in this._model.components)m.isTemplateComp(this._model,t)||(e[t]=this.getComp(t));return e},r.prototype.getScopedRMI=function(e){var t=new this.constructor(this._model,this._onUpdateCallback,{_hooksManager:this._hooksManager,_transaction:this._transaction});return t.getCompIdsFromRole=t.getCompIdsFromRole.bind(t,e),t.getCompIdsFromType=t.getCompIdsFromType.bind(t,e),t.getConfig=t.getConfig.bind(t,e),t},r.prototype.getNestedScopedRMI=function(e){return new this.constructor(e||this._model,this._onUpdateCallback,{_hooksManager:this._hooksManager,_transaction:this._transaction})},r.prototype.getCompIdsFromType=function(e,t,n){var o=d.get(this._model.connections,e),r=d.flatMap(o,Object.keys),a=[],s=i.call(this,n);return r.forEach(function(e){this.getType(e)===t&&s.includes(d.get(this._model.componentsScopes,e))&&a.push(e)},this),a},r.prototype.getCompIdsFromRole=function(e,t,n){var o=this,r=d.get(this._model.connections,[e,t]),a=i.call(this,n);return(r?Object.keys(r):[]).filter(function(e){return a.includes(d.get(o._model.componentsScopes,e))})},r.prototype.getConfig=function(e,t,n,o){var r=d.get(this._model.connections,[e,n]),a=i.call(this,o);return r&&r.hasOwnProperty(t)&&a.includes(d.get(this._model.componentsScopes,t))?r[t]:{}},r.prototype.updateModel=function(e){for(var t in e){var n=a(),o=d.get(this._model.components,t),r=e[t];if(o)for(var i in r)d.has(o,i)&&(d.isObject(o[i])?r[i]?d.assign(o[i],r[i]):o[i]=n[i]:o[i]=r[i])}},r.prototype.getScopedRMIByCompId=function(e){var t=this.getRepeaterItemContext(e);if(d.isEmpty(t))return this;var n=t.displayedRoot,o=t.itemId;return this.getScopedRMIForRepeaterItem(n,o)},r.prototype.getScopedRMIForRepeaterItem=function(e,t){var n=d.clone(this._model),o=m.getAllCompsUnderRoot(n,e),r=o.map(function(e){return f.structure.getUniqueDisplayedId(e,t)});return n.scopesHierarchy=d.clone(n.scopesHierarchy),n.scopesHierarchy.unshift({type:"COMPONENT_SCOPE",id:e,compId:e,additionalData:{itemId:t}}),n.componentsScopes=d.clone(n.componentsScopes),o.forEach(function(e){return n.componentsScopes[e]=null}),r.forEach(function(t){return n.componentsScopes[t]=e}),this.getNestedScopedRMI(n)},r.prototype.getRepeaterItemContext=function(e){var t=d.get(this._model.components,[e,U]);return t?{displayedRoot:t,itemId:f.structure.getItemId(e)}:{}},r.prototype.startTransaction=function(){this._transaction._onTransaction=!0},r.prototype.endTransaction=function(){this._onUpdateCallback&&this._onUpdateCallback(null,"executeBatch",this._transaction._transactionData),this._transaction._onTransaction=!1,this._transaction._transactionData={}},r.prototype.setBatchData=function(e){d.forEach(e,function(e,t){d.forEach(e,function(e,n){switch(n){case"registerEvent":d.forEach(e,function(e){this.registerEvent.call(this,e.contextId,t,e.eventType,e.controllerId,e.callbackId)}.bind(this));break;default:this["set"+d.startCase(n)].call(this,t,e)}}.bind(this))}.bind(this))},r.prototype.registerHook=function(e,t,n){this._hooksManager.registerHook(e,t,n)},r.prototype.getHooks=function(){return this._hooksManager.HOOKS},e.exports=r},function(e,t,n){"use strict";function o(e,t,n){var o=e;n&&(o=T.dropRight(e));var r=T.drop(t?T.dropRight(o):o);return T.join(r,"/")}function r(e,t,n){if(n===L.DYNAMIC_PAGE||n===L.DYNAMIC_PAGE_WITH_QUERY_PARAMS)return i(t);var o=T.find(e,function(e){return e.test(t)}),r=t.match(o);return r=r||[]}function i(e){var t=e.match(S),n=t[1].replace("#","/#").split(/[\/]+/);return T.includes(e,"?")&&n.push(T.last(t)),n}function a(e){return R[e]||e}function s(e,t){var n=T.find(e,{id:t.routerId});return n&&n.prefix}function c(e,t){var n=e.innerRoute&&"/"!==e.innerRoute?"/"+e.innerRoute:"",o=s(t,e)+n,r=a(e.anchorDataId),i={pageId:T.startsWith(o,"/")?o:"/"+o,anchorDataId:r};return i.anchorDataId?G(i):o}function u(e,t,n){var o=d(e.pageId),r=T.find(n,{id:o});return r?r.url:H({pageId:o})}function p(e){var t="mailto:<%=linkObject.recipient%>";return T.has(e,"subject")&&(t+="?subject=<%=linkObject.subject%>"),T.template(t,{variable:"linkObject"})(e)}function l(e,t,n){var o=a(e.anchorDataId);if(y(f(e.pageId)))return"#"+o;var r=d(e.pageId),i=T.find(n,{id:r});return G(i?{pageId:i.url,anchorDataId:o}:{pageId:T.startsWith(r,"/")?r:"/"+r,anchorDataId:o})}function d(e){return e=f(e),y(e)?"":e.replace("#","")}function f(e){if(!e)return e;if(T.isPlainObject(e)){if(e.pageUriSEO)return e.pageUriSEO;if(y(e.id))return j;throw new Error("pageId object should contain pageUriSEO")}return e}function m(e,t){var n=""===e,o=n?T.find(t,"isMainPage"):T.find(t,{url:"/"+e});return T.get(o,"id",e)}function g(e,t){return T.find(t,{name:e[0]})}function h(e){return T.includes(e,"?")?L.DYNAMIC_PAGE_WITH_QUERY_PARAMS:L.DYNAMIC_PAGE}function y(e){return e.replace("#","")===j}function v(e,t){switch(!0){case D.test(e):return L.EXTERNAL;case E.test(e):return L.EMAIL;case M.test(e):return L.SAME_PAGE_ANCHOR_LINK;case O.test(e):return g(i(e),t)?h(e):L.PAGE_TOP;case C.test(e):return g(i(e),t)?h(e):L.PAGE_BOTTOM;case P.test(e):return g(i(e),t)?h(e):L.ANCHOR;case S.test(e):return g(i(e),t)?h(e):L.PAGE;case A.test(e):case x.test(e):return L.DOCUMENT;case U.test(e):return L.PHONE;default:throw new Error("Unsupported link type")}}function w(e,t,n){if(!t||!T.get(F,[t.type,"url"]))throw new Error("Provided link type is not supported");return T.get(F,[t.type,"url"])(t,e,n)}function _(e,t,n,o){var i=v(t,e),a=r(F[i].regex,t,i);return T.get(F,[i,"link"])(i,a,e,o,n)}function I(e){return a(e.anchorDataId)}function k(e){return f(e.pageId)}function b(e){if(!T.isString(e))return{};var t=e.split("&");return T.reduce(t,function(e,t){var n=t.split("=");return e[n[0]]=n[1]?decodeURIComponent(n[1]):null,e},{})}var T=n(0),D=/^(http|https):\/\/(.*)/,E=/^mailto:([^\?]*)(?:\?subject=(.*)?)?/,S=/^\/([^ \?]*)[\?]?(.*)/,O=/^(\/?)([^ \?]*)#(top|SCROLL_TO_TOP)[\?]?(.*)/,C=/^(\/?)([^ \?]*)#(bottom|SCROLL_TO_BOTTOM)[\?]?(.*)/,A=/^document:\/\/(.*)/,x=/^wix:document:\/\/v1\/(.+)\/(.+)/,U=/^tel:(.*)/,P=/^\/([^ \?]*)#([^ \?]*)[\?]?(.*)/,M=/^#([^ \?]*)[\?]?(.*)/,R={SCROLL_TO_TOP:"top",SCROLL_TO_BOTTOM:"bottom"},L={PAGE:"PageLink",DYNAMIC_PAGE:"DynamicPageLink",DYNAMIC_PAGE_WITH_QUERY_PARAMS:"DynamicPageLinkWithQueryParams",EXTERNAL:"ExternalLink",EMAIL:"EmailLink",DOCUMENT:"DocumentLink",PHONE:"PhoneLink",PAGE_TOP:"AnchorLink",PAGE_BOTTOM:"AnchorLink",SAME_PAGE_ANCHOR_LINK:"SamePageAnchorLink",ANCHOR:"AnchorLink"},B=["_blank","_self"],j="masterPage",G=T.template("<%=linkObject.pageId%>#<%=linkObject.anchorDataId%>",{variable:"linkObject"}),H=T.template("/<%=linkObject.pageId%>",{variable:"linkObject"}),F={PageLink:{url:u,link:function(e,t,n,o){var r={type:e,pageId:"#"+m(t[1],o)};return 3===t.length&&t[2]&&T.assign(r,{queryParams:b(t[2])||""}),r},regex:[S]},DocumentLink:{url:T.template("wix:document://v1/<%=linkObject.docId%>/<%=linkObject.name%>",{variable:"linkObject"}),link:function(e,t){return{type:e,docId:t[1],name:T.isUndefined(t[2])?"":t[2]}},regex:[A,x]},PhoneLink:{url:T.template("tel:<%=linkObject.phoneNumber%>",{variable:"linkObject"}),link:function(e,t){return{type:e,phoneNumber:t[1]}},regex:[U]},EmailLink:{url:p,link:function(e,t){var n={type:e,recipient:T.escape(t[1])};return t[2]&&(n.subject=T.escape(t[2])),n},regex:[E]},ExternalLink:{url:T.template("<%=linkObject.url%>",{variable:"linkObject"}),link:function(e,t,n,o,r){if(r&&!T.includes(B,r))throw new Error("Unsupported target value");return{type:e,url:T.template("<%= partA %>://<%= partB%>")({partA:t[1],partB:t[2]}),target:r||"_blank"}},regex:[D]},DynamicPageLink:{url:c,link:function(e,t,n){var r=T.startsWith(T.last(t),"#"),i=T.find(n,{name:t[0]}),a={type:e,innerRoute:o(t,r)||"/",routerId:i.id};if(r){var s=T.last(t).replace("#","");a.anchorDataId=T.get(T.invert(R),s,s)}return a},regex:[O,C,P,S]},DynamicPageLinkWithQueryParams:{url:c,link:function(e,t,n){var r=T.last(t),i=T.startsWith(t[t.length-2],"#"),a=T.find(n,{name:t[0]}),s={type:L.DYNAMIC_PAGE,innerRoute:o(t,i,!0)||"/",routerId:a.id,queryParams:b(r)};if(i){var c=t[t.length-2].replace("#","");s.anchorDataId=T.get(T.invert(R),c,c)}return s},regex:[O,C,P,S]},AnchorLink:{url:l,link:function(e,t,n,o){var r=t[2],i={type:e,pageId:"#"+m(t[1],o),anchorDataId:T.invert(R)[r]||r};return 4===t.length&&t[3]&&T.assign(i,{queryParams:b(t[3])}),i},regex:[P]},SamePageAnchorLink:{url:l,link:function(e,t){var n=t[1],o={type:L.ANCHOR,anchorDataId:T.invert(R)[n]||n,pageId:"#"+j};return 3===t.length&&t[2]&&T.assign(o,{queryParams:b(t[2])}),o},regex:[M]}};e.exports={convertLinkObjectToUrl:w,convertUrlToLinkObject:_,getAnchorDataId:I,getPageId:k,convertQueryParamsToObject:b}},function(e,t,n){"use strict";function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e)return e;var t=/<(ol|ul|h[1-6]|p)(.*?)>/g,n=/class\s*?=\s*["'](.*?)['"]/,o=/(class\s*?=\s*["'])(.*?)(['"])/;return e.replace(t,function(e,t,r){var i=r.match(n);if(!i)return"<"+t+r+' class="'+a[t]+'">';var s=i[1];return/(^|\s)font_[0-9]($|\s)/.test(s)?e:"p"===t&&/\bp[13]\b/i.test(s)?e.replace(/(.*?\bclass\s*?=.*?)\bp([13])\b(.*)/,function(e,t,n,o){return t+("1"===n?"font_7":"font_9")+o}):"<"+t+r.replace(o,function(e,n,o,r){return""+n+a[t]+" "+o+r})+">"})}function r(e){return e=o(e)}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=/<(ol|ul|h[1-6]|p)(.*?)>/g,n=/(class\s*=['"][^'"]*?)\bfont_([79])\b/;return e.replace(t,function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=a[t],i=new RegExp("(class\\s*=['\"].*?)"+r);return i.test(o)?e=e.replace(i,"$1"):"p"===t&&n.test(o)&&(e=e.replace(n,function(e,t,n){return t+("7"===n?"p1":"p3")})),e.replace(/class\s*=(['"])\s*\1/,"").replace(/class\s*=(['"])\s*(.*?)\s*\1/,function(e,t,n){return"class="+t+n+t}).replace(/(.+)\s{2,}/g,"$1 ").replace(/\s+>/,">")})}var a={p:"font_8",h1:"font_0",h2:"font_2",h3:"font_3",h4:"font_4",h5:"font_5",h6:"font_6",ol:"font_8",ul:"font_8"};e.exports={applyTransformationForSetHtml:r,applyTransformationForGetHtml:i}},function(e,t,n){"use strict";var o={"wysiwyg.viewer.components.SiteButton":"Button","wysiwyg.viewer.components.PopupCloseTextButton":"Button","wysiwyg.viewer.components.PopupCloseIconButton":"Button","wysiwyg.common.components.imagebutton.viewer.ImageButton":"Button","wysiwyg.viewer.components.WPhoto":"Image","wysiwyg.viewer.components.FooterContainer":"Footer","wysiwyg.viewer.components.HeaderContainer":"Header","wysiwyg.viewer.components.WRichText":"Text","mobile.core.components.Page":"Page","wysiwyg.viewer.components.inputs.TextInput":"TextInput","wysiwyg.viewer.components.inputs.TextAreaInput":"TextBox","wysiwyg.viewer.components.inputs.DatePicker":"DatePicker","wysiwyg.viewer.components.BoxSlideShow":"Slideshow","wysiwyg.viewer.components.StripContainerSlideShow":"Slideshow","wysiwyg.viewer.components.SlideShowGallery":"Gallery","wysiwyg.viewer.components.SliderGallery":"Gallery","wysiwyg.viewer.components.MatrixGallery":"Gallery","wysiwyg.viewer.components.PaginatedGridGallery":"Gallery","mobile.core.components.Container":"Box","wysiwyg.viewer.components.Group":"Box","platform.components.AppController":"AppController","wysiwyg.viewer.components.svgshape.SvgShape":"Shape","wysiwyg.viewer.components.VectorImage":"Shape","wysiwyg.viewer.components.inputs.Checkbox":"Checkbox","wixui.ToggleSwitch":"ToggleSwitch","wysiwyg.viewer.components.inputs.RadioGroup":"RadioButtonGroup","wysiwyg.viewer.components.BoxSlideShowSlide":"Slide","wysiwyg.viewer.components.StripContainerSlideShowSlide":"Slide","wysiwyg.viewer.components.inputs.ComboBoxInput":"Dropdown","wysiwyg.viewer.components.Column":"Column","wysiwyg.viewer.components.StripColumnsContainer":"ColumnStrip","wysiwyg.viewer.components.Grid":"Table","wysiwyg.viewer.components.inputs.FileUploader":"UploadButton","wysiwyg.common.components.anchor.viewer.Anchor":"Anchor","wysiwyg.viewer.components.tpapps.TPASection":"IFrame","wysiwyg.viewer.components.tpapps.TPAMultiSection":"IFrame","wysiwyg.viewer.components.tpapps.TPAGluedWidget":"IFrame","wysiwyg.viewer.components.HtmlComponent":"HtmlComponent","wysiwyg.viewer.components.GoogleMap":"GoogleMap","wysiwyg.viewer.components.Video":"Video","wysiwyg.viewer.components.HoverBox":"HoverBox","tpa.viewer.components.Freestyle":"Gallery","tpa.viewer.components.Honeycomb":"Gallery","tpa.viewer.components.Accordion":"Gallery","wysiwyg.viewer.components.tpapps.TPA3DCarousel":"Gallery","wysiwyg.viewer.components.tpapps.TPA3DGallery":"Gallery","tpa.viewer.components.Impress":"Gallery","tpa.viewer.components.Masonry":"Gallery","tpa.viewer.components.Collage":"Gallery","tpa.viewer.components.StripSlideshow":"Gallery","tpa.viewer.components.StripShowcase":"Gallery","tpa.viewer.components.Thumbnails":"Gallery","wysiwyg.viewer.components.tpapps.TPAWidget":"IFrame","wysiwyg.common.components.verticalmenu.viewer.VerticalMenu":"VerticalMenu","wysiwyg.viewer.components.LoginSocialBar":"AccountNavBar","wysiwyg.viewer.components.Repeater":"Repeater","wysiwyg.viewer.components.MediaContainer":"Container","wysiwyg.viewer.components.mobile.TinyMenu":"MobileMenu"},r={"142bb34d-3439-576a-7118-683e690a1e0d":"Gallery"};e.exports={sdkTypeByViewerType:o,sdkTypeByWidgetId:r,defaultSdkType:"HiddenCollapsedElement"}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(0),a=function(){function e(t){o(this,e),this._typesData=t}return r(e,[{key:"getSdkType",value:function(e,t){var n=this._typesData,o=n.sdkTypeByViewerType,r=n.sdkTypeByWidgetId,i=n.defaultSdkType;return r[t]||o[e]||i}},{key:"getFullSdkType",value:function(e,t){return"$w."+this.getSdkType(e,t)}},{key:"getPotentialViewerTypes",value:function(e){var t=this._typesData,n=t.sdkTypeByViewerType,o=t.sdkTypeByWidgetId,r=i.keys(n),a=r.filter(function(t){return n[t]===e});return i.includes(i.values(o),e)&&a.push("wysiwyg.viewer.components.tpapps.TPAWidget"),a}},{key:"Types",get:function(){var e=this._typesData,t=e.sdkTypeByViewerType,n=e.sdkTypeByWidgetId,o=i.uniq(i.values(t).concat(i.values(n)));return i.zipObject(o,o)}},{key:"defaultSdkType",get:function(){return this._typesData.defaultSdkType}}]),e}();e.exports=a},function(e,t,n){"use strict";function o(e){return f(e)}function r(e){return m(e)}function i(e,t,n){return t&&(e[n]=t),e}function a(e){if(g.test(e)){var t=e.match(g)||[0,0,e];return c(t,3)[2]}return e}function s(e){if(g.test(e)){var t=e.match(g)||[0,0,e],n=c(t,6),o=n[2],r=n[3],a=n[4],s=n[5];return u.reduce({uri:o,width:r,height:a,title:s},i,{})}return{uri:e}}var c=function(){function e(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=n(0),p="image://",l="wix:document://",d="v1",f=u.template(p+d+"/${uri}/${width}_${height}/${title}"),m=u.template(l+d+"/${uri}/${filename}"),g=/^image:\/\/(.*)\/(.*)\/(.*)_(.*)\/(.*)/;e.exports={generateWixCodeImageUri:o,generateWixCodeDocumentUri:r,extractImageRelativeUriFromWixUri:a,extractImageDataFromWixUri:s}},function(e,t,n){"use strict";function o(e,t,n){var o=f.get(e,"connections"),r=f.keys(o);f.forEach(r,function(e){var r=f.keys(f.get(o,e));f.forEach(r,function(r){var i=f.keys(f.get(o,[e,r]));f.forEach(i,function(i){if(f.includes(t,i)){var a=f.get(o,[e,r,i]);f.forEach(n,function(t){var n=m.structure.getUniqueDisplayedId(i,t);f.set(o,[e,r,n],f.cloneDeep(a))})}})})})}function r(e,t,n){f.forEach(t,function(t){f.forEach(n,function(n){var o=m.structure.getUniqueDisplayedId(t,n);e.componentsScopes[o]=null})})}function i(e,t,n,o){f.forEach(t,function(t){f.forEach(n,function(n){var r=m.structure.getUniqueDisplayedId(t,n),i=e.components[t],a=f.cloneDeep(i);a.displayedOnlyComponents=[],a.children=f.map(i.children,function(e){return m.structure.getUniqueDisplayedId(e,n)}),a.parent=i.parent===o?o:m.structure.getUniqueDisplayedId(i.parent,n),a.displayedRoot=o,a.isDisplayed=!!f.get(e.components[o],"isDisplayed"),f.forEach(m.structure.SPLITTED_DATA_TYPES,function(e){var t=a[e];t.id&&(t.id=m.structure.getUniqueDisplayedId(a[e].id,n),f.forEach(t,function(e,o){f.isObject(e)&&e.id&&(t[o].id=m.structure.getUniqueDisplayedId(t[o].id,n))}))}),e.components[r]=a})})}function a(e,t,n,a){o(e,t,n),i(e,t,n,a),r(e,t,n)}function s(e,t,n){var o=f.get(e,"connections"),r=f.keys(o);f.forEach(r,function(e){var r=f.keys(f.get(o,[e]));f.forEach(r,function(r){var i=f.keys(f.get(o,[e,r]));f.forEach(i,function(i){var a=m.structure.getItemId(i),s=m.structure.getOriginalId(i);a&&f.includes(n,a)&&f.includes(t,s)&&delete o[e][r][i]})})})}function c(e,t,n){f.forEach(t,function(t){f.forEach(n,function(n){var o=m.structure.getUniqueDisplayedId(t,n);delete e.componentsScopes[o]})})}function u(e,t,n){f.forEach(t,function(t){f.forEach(n,function(n){var o=m.structure.getUniqueDisplayedId(t,n);delete e.components[o]})})}function p(e,t,n){s(e,t,n),c(e,t,n),u(e,t,n)}function l(e,t,n,o){if(o.items){var r=g.getAllCompsUnderRoot(e._model,n),i=f.get(e._model.components,[n,"data"]),s=m.items.getAddedItems(i.items,o.items);a(e._model,r,f.map(s,"item._id"),n);var c=m.items.getRemovedItems(i.items,o.items);p(e._model,r,f.map(c,"item._id")),f.forEach(r,function(t){e._model.components[t].displayedOnlyComponents=f.map(o.items,function(e){return m.structure.getUniqueDisplayedId(t,e)})})}}function d(e,t,n){var o=arguments,r=e._model;if("registerEvent"!==t&&g.isTemplateComp(r,n)){var i=f.get(r,["components",n]),a=arguments[3];r.components[n][t]=f.defaults({},a,i[t])}var s=f.get(e._model.components,[n,"displayedOnlyComponents"]);if(!f.isEmpty(s)){var c="set"+f.startCase(t);if("registerEvent"===t)return c="registerEvent",void f.forEach(s,function(t){var n=[].concat(Array.prototype.slice.call(o));e[c].apply(e,[n[3],t].concat(n.splice(4)))});f.forEach(s,function(n){var r=[].concat(Array.prototype.slice.call(o));if("data"===t&&!f.isFunction(f.last(r)))return void e.setDataWithoutUpdate.apply(e,[n].concat(r.splice(3)));e[c].apply(e,[n].concat(r.splice(3)))})}}var f=n(0),m=n(1),g=n(9);e.exports={updateRepeaterItems:l,syncRepeaterItemData:d}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(0),a={all:"all",data:"data"},s="*",c=function(){function e(){o(this,e),this._hooks={}}return r(e,[{key:"validateHookName",value:function(e){if(!a[e])throw"Invalid Hook Name "+e}},{key:"unregisterAllHooks",value:function(){this._hooks={}}},{key:"unregisterHooks",value:function(e){var t=this;i.forEach(e,function(e){return delete t._hooks[e]})}},{key:"executeHooksAndUpdateValue",value:function(e,t,n,o,r){function s(a){var s=this;if(a){var c=a[n]||[],u=a["*"]||[];i.forEach(c.concat(u),function(n){n.apply(s,[e,t,o].concat(r||[]))})}}var c=this._hooks[t],u=this._hooks[a.all];s(c),s(u)}},{key:"registerHook",value:function(e,t,n){if(this.validateHookName(e),n){var o=this._hooks[e];o||(this._hooks[e]=o={}),t=t||s;var r=o[t];r||(o[t]=r=[]),r.push(n)}}},{key:"HOOKS",get:function(){return a}}]),e}();e.exports=c},function(e,t,n){"use strict";function o(e){return l.map(e,function(e){return l.isString(e)?e:e._id})}function r(e,t){var n=l.map(e,function(e){return l.isString(e)?{_id:e}:e});return l.reduce(n,function(e,n,o){return l.includes(t,n._id)&&e.push({item:n,index:o}),e},[])}function i(e,t){var n=o(t),i=o(e);return r(t,l.difference(n,i))}function a(e,t){var n=o(t),i=o(e);return r(e,l.difference(i,n))}function s(e,t){return e+f+t}function c(e){if(e)return e.split(f)[0]}function u(e){if(e)return e.split(f)[1]}function p(e,t,n){var o=d.getAllCompsUnderRoot(l.get(e,"_model"),t),r=l.compact(l.map(n,function(e){return l.get(e,"item._id")}));return l.reduce(r,function(e,t){return e.concat(l.map(o,function(e){return s(e,t)}))},[])}var l=n(0),d=n(9),f="__",m=["data","design"];e.exports={getAddedItems:i,getRemovedItems:a,getUniqueDisplayedId:s,getOriginalId:c,getItemId:u,getTemplateCompIds:p,SPLITTED_DATA_TYPES:m}},function(e,t,n){"use strict";var o=n(11),r=n(12),i=n(16),a=n(13),s=n(8),c=n(1),u=n(15),p=n(6),l=n(7),d=n(14),f=n(10);e.exports={RemoteModelInterface:o,linkUtils:r,uriUtils:i,richTextUtils:a,videoUrlsUtils:s,repeaterUtils:c,backgroundUtils:p,svgUtils:l,componentsHooks:f,typeUtils:new u(d)}}])});
//# sourceMappingURL=platformUtils-bundle.js.map